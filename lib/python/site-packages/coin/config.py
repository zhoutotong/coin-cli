# -*- coding: utf-8 -*-
#ÔºÅ/bin/env python3
import os
import toml
import coin.utils

class Configration:
    def __init__(self, cfg_file = os.path.join(os.environ['COIN_ROOT'], 'config/coin.toml')):
        self.cfg_file = cfg_file
        self.config = None

    def load(self):
        self.config = toml.load(self.cfg_file)
    
    def save(self):
        with open(self.cfg_file, 'w') as f:
            toml.dump(self.config, f)

    def read_package(self, package):
        if not self.config:
            self.load()
            
        os_tag = coin.utils.os_tag()
        
        pkg_list = self.config['packages']
        
        if os_tag not in pkg_list:
            return None
        
        if package not in pkg_list[os_tag]:
            return None
        
        return pkg_list[os_tag][package]
